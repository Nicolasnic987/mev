<!DOCTYPE html>
<html lang="ja">

<head>
  <meta chartset="utf-8">
  <title>me/v</title>
  <link rel="stylesheet" href="./mev.css" type="text/css">
</head>

<body style="margin:0; overflow:hidden">
  <div style="position: absolute; left:30%; top: 200px; width:40%" id="vue_start_dialog">
    <h2>VRMかFBXを読み込んで編集開始</h2>

    <section style="text-align: center">
      <div id="dropzone"
        style="height: 100px; border-style:dotted; border-color: grey; border-width: 3px; text-align: center; padding-top: 24px"
        v-bind:style="{backgroundColor: bgColor}" @dragover="fileDragover" @dragleave="fileDragleave" @drop="fileDrop">
        <img src="ui_asset/baseline-open_in_browser-24px.svg" width="48px" height="48px" style="filter:contrast(10%)">
        <br />
        ファイルをドロップする
      </div>

      または<br />
      <input type="file" @change="fileSelect"></input>
    </section>

    <section>
      <span class="text-aux">※編集はすべてブラウザ内で行われ、読み込んだデータがアップロードされることはありません。</span>
    </section>
  </div>

  <div style="position: absolute; left:8px; top: 8px; width: 240px" id="vue_menu">
    <h1>{{avatarName}}</h1>
    <section>
      <h2>身体</h2>
      <div class="normal-text">身長: {{avatarHeight}}</div>
    </section>

    <section>
      <h2>表情</h2>
      <div v-for="emotionGroup in emotionGroups" style="padding-bottom: 8px">
        <span v-for="emotion in emotionGroup" class="chip-button"
          :class="{'chip-button-active': emotion.label === currentEmotion}" @click="clickEmotion(emotion.label)">{{emotion.label}}</span>
      </div>
    </section>

    <section style="max-height:600px; overflow-y:auto">
      <h2>表情 (dev)</h2>
      <div v-for="blendshape in blendshapes">
        {{blendshape.name}} {{blendshape.content}}
      </div>
    </section>

    <section style="max-height:600px; overflow-y:auto">
      <h2>パーツ</h2>
      <div v-for="part in parts">
        {{part.visibility}} {{part.name}} - {{part.numTris}} <br />
        <button @click="toggleVisible(part.name)">toggle</button>
        <img style="border: 1px; border-color:black" v-bind:src="part.textureUrl" height="48px" /><span
          class="normal-text">{{part.shaderName}}</span>
      </div>
    </section>

    <section v-if=" finalVrmReady">
      <h2>VRMに出力</h2>
      <div class="normal-text">サイズ: {{finalVrmSizeApprox}}</div>
      <div class="normal-text">ポリゴン: {{finalVrmTris}}</div>
      <button @click="downloadVrm">ダウンロード</button>
    </section>
  </div>

  <!-- Debug -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.js"
    integrity="sha256-ufGElb3TnOtzl5E4c/qQnZFGP+FYEZj5kbSEdJNrw0A=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/103/three.js"
    integrity="sha256-Dz4QEGvodtXoy6gQW91o97WHBVvVXj7WsVA2LOUigbs=" crossorigin="anonymous"></script>

  <!-- Release -->
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.min.js"
    integrity="sha256-chlNFSVx3TdcQ2Xlw7SvnbLAavAQLO0Y/LBiWX04viY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/103/three.min.js"
    integrity="sha256-T4lfPbatZLyNhpEgCvtmXmlhOUq0HZHkDX4cMlQWExA=" crossorigin="anonymous"></script>-->

  <script src="./third_party/three_gltf_loader.js"></script>
  <script src="./third_party/three_gltf_exporter.js"></script>
  <script src="./third_party/zlib.js"></script>
  <script src="./third_party/three_fbx_loader.js"></script>
  <script src="./third_party/three_orbit_controls.js"></script>
  <script src="./third_party/file_saver.js"></script>
  <script type="module" src="./mev.js"></script>
</body>

</html>